const productBtnList=document.querySelectorAll(".product-item__link"),modalInfoWindow=document.querySelector(".modal-dialog"),modalInfoTab=document.querySelector(".modal"),modalInfoCloseBtn=document.querySelector(".modal__close-btn"),modalCartWindow=document.querySelector(".cart-modal"),modalCartTab=document.querySelector(".cart"),modalCartCloseBtn=document.querySelector(".cart__close"),cartTotalPrice=document.querySelector(".cart__total-num");let product={name:"",price:"",img:""};function closeModal(e,t,l,a){l=e==l||l.contains(e),e=e==a||a.contains(e);l&&!e||displayWindow(t)}function displayWindow(e){e.classList.toggle("active"),document.querySelector("body").classList.toggle("lock-body")}function addToCart(e){e.preventDefault();let t=e.target.parentElement.parentElement;product.name=t.querySelector(".product-item__title-link").innerText,product.price=parseInt(t.querySelector(".product-item__current-price").innerText),product.img=t.querySelector(".product-item__img").getAttribute("src"),""!=product.name&&null!=product.name&&""!=product.price&&null!=product.price&&""!=product.img&&null!=product.img&&(fillModal(product.name,product.price,product.img),displayWindow(modalInfoWindow),pushToCart(),calcTotalSum())}function fillModal(e,t,l="../images/icons/flower-frame.png"){let a=modalInfoWindow.querySelector(".modal__name"),n=modalInfoWindow.querySelector(".modal__price span"),o=modalInfoWindow.querySelector(".modal__img");a.innerText=e,n.innerText=t,o.setAttribute("src",l)}modalCartWindow.addEventListener("click",e=>{e.preventDefault();e=e.target;closeModal(e,modalCartWindow,modalCartTab,modalCartCloseBtn),deleteItem(e),changeInputCount(e)}),modalInfoWindow.addEventListener("click",e=>{e.preventDefault();e=e.target;closeModal(e,modalInfoWindow,modalInfoTab,modalInfoCloseBtn),e==modalInfoTab.querySelector(".modal__link")&&(displayWindow(modalInfoWindow),displayWindow(modalCartWindow))}),productBtnList.forEach(e=>{e.addEventListener("click",addToCart)});let cartTable=document.querySelector(".cart-modal .table__body"),rowTemplate='<tr class="table__row"><td class="table__cell table__cell-img"><img class="table__img" src="" alt="Товар"></td><td class="table__cell table__cell-name"><p class="table__name"></p></td><td class="table__cell"><p class="table__price"><span class="table__price-num"></span> грн</p></td><td class="table__cell"><div class="table__input-box"><div class="table__input-minus">-</div><input class="table__input-field" type="number" value="1" min="1" max="100" readonly><div class="table__input-plus">+</div></div></td><td class="table__cell"><p class="table__sum"><span class="table__sum-num"></span> грн</p></td><td class="table__cell"><span class="table__delete"></span></td></tr>';function pushToCart(){cartTable.innerHTML+=rowTemplate;let e=cartTable.lastChild,t=e.querySelector(".table__img"),l=e.querySelector(".table__name"),a=e.querySelector(".table__price-num"),n=e.querySelector(".table__sum-num");t.setAttribute("src",product.img),l.textContent=product.name,a.textContent=product.price,n.textContent=product.price}function deleteItem(t){if(t.classList.contains("table__delete")){let e=t.parentElement.parentElement;e.remove(),calcTotalSum()}}function calcTotalSum(){let e=document.querySelectorAll(".table__sum-num"),t=0;e.forEach(e=>{e=parseInt(e.textContent);Number.isInteger(e)&&(t+=parseInt(e))}),cartTotalPrice.innerText=t}function changeProductSum(e){let t=e.parentElement.parentElement.parentElement,l=t.querySelector(".table__sum-num");var a=parseInt(t.querySelector(".table__price-num").textContent),e=parseInt(t.querySelector(".table__input-field").value);l.innerText=a*e}function changeInputCount(e){let t=null;e.classList.contains("table__input-plus")?(t=e).previousElementSibling.stepUp():e.classList.contains("table__input-minus")&&(t=e).nextElementSibling.stepDown(),changeProductSum(e),calcTotalSum()}